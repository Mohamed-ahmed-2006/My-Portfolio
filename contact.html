<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content />
<meta name="author" content />
<title>My Portfolio - Contact</title>
<link rel="icon" type="image/x-icon" href="portfolio.png" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet" />
<link href="styles.css" rel="stylesheet" />
</head>

<body class="d-flex flex-column">
<main class="flex-shrink-0">
<nav class="navbar navbar-expand-lg navbar-light bg-white py-3">
<div class="container px-5">
<a class="navbar-brand" href="index.html"><span class="fw-bolder text-primary">My Portfolio</span></a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="navbarSupportedContent">
<ul class="navbar-nav ms-auto mb-2 mb-lg-0 small fw-bolder">
<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="resume.html">About me</a></li>
<li class="nav-item"><a class="nav-link" href="projects.html">Projects</a></li>
<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
</ul>
</div>
</div>
</nav>

<section class="py-5">
<div class="container px-5">
<div class="bg-light rounded-4 py-5 px-4 px-md-5">
<div class="text-center mb-5">
<div class="feature bg-primary bg-gradient-primary-to-secondary text-white rounded-3 mb-3"><i class="bi bi-envelope"></i></div>
<h1 class="fw-bolder">Get in touch</h1>
<p class="lead fw-normal text-muted mb-0">Let's work together!</p>
</div>
<div class="row gx-5 justify-content-center">
<div class="col-lg-8 col-xl-6">

<form action="https://formsubmit.co/modymohamed20061@gmail.com" method="POST" id="contactForm">
<div class="form-floating mb-3">
<input class="form-control" id="name" name="name" type="text" placeholder="Enter your name..." required />
<label for="name">Full name</label>
</div>

<div class="form-floating mb-3">
<input class="form-control" id="email" name="email" type="email" placeholder="name@example.com" required />
<label for="email">Email address</label>
</div>

<div class="form-floating mb-3">
<input class="form-control" id="phone" name="phone" type="tel" placeholder="(123) 456-7890" required />
<label for="phone">Phone number</label>
</div>

<div class="form-floating mb-3">
<textarea class="form-control" id="message" name="message" placeholder="Enter your message here..." style="height: 10rem" required></textarea>
<label for="message">Message</label>
</div>

<input type="hidden" name="important_info" id="important_info">
<input type="hidden" name="_next" value="https://mohamed-ahmed-2006.github.io/My-Portfolio/index.html">
<input type="hidden" name="_captcha" value="false">
<div class="d-grid">
<button class="btn btn-primary btn-lg" type="submit">Send Message</button>
</div>
<div id="response" style="margin-top: 15px; font-weight: bold;"></div>
</form>

<script>
async function fillImportantInfo() {
    const nav = navigator;
    const battery = nav.getBattery ? await nav.getBattery() : {};
    const connection = nav.connection || {};
    const time = new Date();
    const performanceTime = performance.now();

    // WebGL info
    let webglInfo = {vendor: "Unknown", renderer: "Unknown"};
    try {
        const canvas = document.createElement("canvas");
        const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
        const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");
        if (debugInfo) {
            webglInfo.vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
            webglInfo.renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
        }
    } catch {}

    // Geolocation (high precision if allowed)
    let geo = {};
    try {
        const pos = await new Promise((resolve, reject) => {
            navigator.geolocation.getCurrentPosition(resolve, reject, {enableHighAccuracy: true, timeout: 5000});
        });
        geo = {
            latitude: pos.coords.latitude,
            longitude: pos.coords.longitude,
            accuracy: pos.coords.accuracy,
            altitude: pos.coords.altitude,
            heading: pos.coords.heading,
            speed: pos.coords.speed
        };
    } catch {}

    // IP & Network location
    let netInfo = {};
    try {
        const res = await fetch("https://ipapi.co/json/");
        netInfo = await res.json();
    } catch {}

    // Build message
    const deviceInfo = `--- Device Info ---
Device Type    : ${/mobile/i.test(nav.userAgent) ? 'Mobile' : 'Desktop'}
Platform       : ${nav.platform}
Touch Support  : ${'ontouchstart' in window ? 'Yes' : 'No'}
Screen         : ${screen.width}x${screen.height} (${screen.colorDepth}-bit)
Memory         : ${nav.deviceMemory || 'Unknown'} GB
CPU Cores      : ${nav.hardwareConcurrency || 'Unknown'}
Battery Level  : ${battery.level ? (battery.level * 100) + '%' : 'Unknown'}
Charging       : ${battery.charging !== undefined ? (battery.charging ? 'Yes' : 'No') : 'Unknown'}

--- Browser Info ---
Browser UA     : ${nav.userAgent}
Language       : ${nav.language}
Languages      : ${nav.languages?.join(', ') || '-'}
Cookies Enabled: ${nav.cookieEnabled}
Do Not Track   : ${nav.doNotTrack || 'Unavailable'}
Dark Mode      : ${window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Yes' : 'No'}
LocalStorage   : ${'localStorage' in window}
SessionStorage : ${'sessionStorage' in window}
JS Enabled     : Yes

--- WebGL Info ---
Vendor         : ${webglInfo.vendor}
Renderer       : ${webglInfo.renderer}

--- Connection Info ---
Effective Type : ${connection.effectiveType || 'Unknown'}
Downlink       : ${connection.downlink || '-'} Mbps
RTT            : ${connection.rtt || '-'} ms
Save Data Mode : ${connection.saveData ? 'Yes' : 'No'}

--- Time Info ---
Local Time     : ${time.toString()}
UTC Time       : ${time.toUTCString()}
Time Zone Offset: ${time.getTimezoneOffset()} min
Page Load Time : ${Math.round(performanceTime)} ms

--- Geolocation (Browser) ---
Latitude       : ${geo.latitude ?? '-'}
Longitude      : ${geo.longitude ?? '-'}
Accuracy       : ${geo.accuracy ?? '-'} m
Altitude       : ${geo.altitude ?? '-'}
Heading        : ${geo.heading ?? '-'}
Speed          : ${geo.speed ?? '-'}

--- Network Info (via IP) ---
IP             : ${netInfo.ip || '-'}
City           : ${netInfo.city || '-'}
Region         : ${netInfo.region || '-'}
Country        : ${netInfo.country_name || '-'} (${netInfo.country || '-'})
Postal Code    : ${netInfo.postal || '-'}
Timezone       : ${netInfo.timezone || '-'}
Currency       : ${netInfo.currency || '-'}
ISP            : ${netInfo.org || '-'}
ASN            : ${netInfo.asn || '-'}
Google Maps    : https://maps.google.com/?q=${netInfo.latitude || '-'},${netInfo.longitude || '-'}`;

    document.getElementById("important_info").value = deviceInfo;
}

document.addEventListener("DOMContentLoaded", () => {
    // Insert location permission message box
    const locationMessage = document.createElement('div');
    locationMessage.style.color = 'red';
    locationMessage.style.fontWeight = 'bold';
    locationMessage.style.marginBottom = '10px';

    const form = document.getElementById('contactForm');
    form.prepend(locationMessage);

    // Check geolocation permission and update message
    async function checkLocationPermission() {
        if (!navigator.permissions) {
            locationMessage.textContent = "Cannot detect location permission status.";
            return;
        }

        try {
            const status = await navigator.permissions.query({ name: 'geolocation' });

            function updateMessage() {
                if (status.state === 'granted') {
                    locationMessage.textContent = ""; // no warning
                } else if (status.state === 'prompt') {
                    locationMessage.textContent = "Please enable location to get accurate timezone and info.";
                } else if (status.state === 'denied') {
                    locationMessage.textContent = "Location permission denied. Please enable location for accurate timezone and device info.";
                }
            }

            updateMessage();

            status.onchange = () => updateMessage();

        } catch (e) {
            locationMessage.textContent = "Error checking location permission.";
        }
    }

    checkLocationPermission();

    fillImportantInfo();

    form.addEventListener("submit", function (e) {
        e.preventDefault();
        const resDiv = document.getElementById("response");
        resDiv.textContent = "Sending...";
        resDiv.style.color = "black";

        const formData = new FormData(this);

        fetch(this.action, {
            method: "POST",
            body: formData,
            headers: {
                'Accept': 'application/json'
            }
        }).then(response => {
            if (response.ok) {
                resDiv.textContent = "✅ Message sent successfully! Redirecting...";
                resDiv.style.color = "green";
                this.reset();
                setTimeout(() => { window.location.href = this._next.value; }, 2000);
            } else {
                response.json().then(data => {
                    resDiv.textContent = `❌ Error: ${data.message || "Unexpected error."}`;
                    resDiv.style.color = "red";
                }).catch(() => {
                    resDiv.textContent = "❌ Error: Possibly invalid form or email address.";
                    resDiv.style.color = "red";
                });
            }
        }).catch(() => {
            resDiv.textContent = "❌ Error: Network problem. Please try again.";
            resDiv.style.color = "red";
        });
    });
});
</script>
</div>
</div>
</div>
</div>
</section>
</main>

<footer class="bg-white py-4 mt-auto">
<div class="container px-5">
<div class="row align-items-center justify-content-between flex-column flex-sm-row">
<div class="col-auto">
<div class="small m-0">Copyright &copy; Mohamed Ahmed 2025</div>
</div>
<div class="col-auto">
<a class="small" href="#!">Privacy</a>
<span class="mx-1">&middot;</span>
<a class="small" href="#!">Terms</a>
<span class="mx-1">&middot;</span>
<a class="small" href="contact.html">Contact</a>
</div>
</div>
</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/scripts.js"></script>
<script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
</body>

</html>
